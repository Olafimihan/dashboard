<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Kode is a Premium Bootstrap Admin Template, It's responsive, clean coded and mobile friendly">
    <meta name="keywords" content="bootstrap, admin, dashboard, flat admin template, responsive," />

    <title>Survey - Admin dashboard</title>

    <!-- ========== Css Files ========== -->
    <link href="css/root.css" rel="stylesheet">
      
    <!-- <script src="js/jquery-3.3.1.js"></script> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.1/socket.io.js" ></script>        
    <script src="js/socket.js" ></script> -->

    <script type="text/javascript" > 
    
    </script>
  </head>
  <body >
  <!-- Start Page Loading -->
  <div class="loading"><img src="img/loading.gif" alt="loading-img"></div>
  <!-- End Page Loading -->
 <!-- //////////////////////////////////////////////////////////////////////////// --> 
  <!-- START TOP -->
  <div id="top" class="clearfix">

    <!-- Start App Logo -->
    <div class="applogo">
      <a href="index.html" class="logo">Survey</a>
    </div>
    <!-- End App Logo -->
    <h1 class="text-center">Project Questions Setup</h1>

     
  </div>
  <!-- END TOP -->
 <!-- //////////////////////////////////////////////////////////////////////////// --> 


<!-- //////////////////////////////////////////////////////////////////////////// --> 
<!-- START SIDEBAR -->
<div class="sidebar clearfix">

    <ul class="sidebar-panel nav" >
        
        <li class="sidetitle">MAIN</li>

        <li class='newproject' ><a href="project.html"><span class="icon color5"><i class="fa fa-home"></i></span>New Project<span class="label label-default">2</span></a></li>
        <li class='questionaire'><a href="questions.html"><span class="icon color6"><i class="fa fa-pencil"></i></span>Project Questionaire<span class="label label-default">19</span></a></li>
        
        <li  class='data'><a href="#"><span class="icon color9"><i class="fa fa-th"></i></span>Data Tables<span class="caret"></span></a>
            <ul>
            <li><a href="datatable.html"><span class="icon color8"><i class="fa fa-database"></i></span>Raw Data</a></li>
            <li><a href="graphtable.html"><span class="icon color8"><i class="fa fa-bar-chart"></i></span>Graphical Data</a></li>
            </ul>
        </li>

        <!-- <li><a href="users.html"><span class="icon color8"><i class="fa fa-user"></i></span>Setup BA Device</a></li>      -->
        <li class='users'><a href="users.html"><span class="icon color8"><i class="fa fa-users"></i></span>Setup Clients</a></li>     
        <!-- <li><a href="mapdevice.html"><span class="icon color8"><i class="fa fa-android"></i></span>Map Device to Project </a></li>      -->
        <li class='mapping'><a href="mapuser.html"><span class="icon color8"><i class="fa fa-android"></i></span>Map Users to Project </a></li>     
        <li><a href="support.html"><span class="icon color8"><i class="fa fa-home"></i></span>Support Tickets</a></li>     

    </ul> 

</div>
<!-- END SIDEBAR -->
<!-- //////////////////////////////////////////////////////////////////////////// --> 

 <!-- //////////////////////////////////////////////////////////////////////////// --> 
<!-- START CONTENT -->
<div class="content">

  
 <!-- //////////////////////////////////////////////////////////////////////////// --> 
<!-- START CONTAINER -->
<div class="container-widget">
  
  <!-- Start Fifth Row -->
  <div class="row">

    <!-- Start Project Stats -->

    <div class="container" id="about">
        <input type="hidden" class="projectid" >
          
        <!-- <div class="holder" > -->
             
            <div class="row col-md-3" id="r2" >
                <!-- <h2 class="text-center">Project Questions Setup</h2> -->
                <form method="GET" action="/board.html">
                    <div id="errmsg" style="height: auto; font-size: 20px; font-weight: bold; text-align: center; color: #f50"></div>
                    <input type="hidden" name="usermail" id="usermail"  >
                                             
                    <div class="form-group col-md-12">
                        <label for="projectid" class="col-md-5" > Project </label>
                        <select class="form-control col-md-7" id="projectid" name="projectid" onchange="getQuestion(this.value)">
                             
                        </select>                            
                    </div>
                    
                    <div class="form-group col-md-12">
                        <label for="title" class="col-md-5" >Question</label>
                        <textarea name="question" id="question" cols="50" rows="5" class="form-control col-md-7" placeholder="Enter new question..."></textarea>
                        <!-- <input type="text" name="question" id="question" autocomplete="off" class="form-control col-md-7" placeholder="Enter new question..."> -->
                    </div>
                    
                    <div class="form-group col-md-12">
                        <label for="position" class="col-md-5" >Question Position</label>
                        <input type="number" name="position" id="position" autocomplete="off" class="form-control col-md-2" placeholder="Question position...">                            
                    </div>                
                    
                    <div class="form-group col-md-12">
                        <label for="projectid" class="col-md-5" > Response Required </label>
                        <select class="form-control col-md-7" id="required" name="required"  >
                          <option value="0">question required?...</option>
                          <option value="yes">YES</option>
                          <option value="no">NO</option>        
                        </select>                            
                    </div>
                    
                    <div class="form-group col-md-12" >
                        <button type="button" id="save" class="btn btn-success" onclick="addquestion()" >Submit</button>    
                        <button type="submit" class="btn btn-primary">Close</button>        
                    </div>
                    
                </form>

            </div>

            <div class="row col-md-9 hidden" id="r3" style="height: 400px; overflow: scroll; width: 600px" >
                <h3 style="text-align: center; background-color: #6F4E37; color: #ffffff">Existing Questions: <p id='questtotal'></p></h3> 

                <div class="table-responsive" style="width: auto; background-color: whitesmoke; overflow: scroll" id="result">

                </div> 
            </div>

 
 
    </div><!-- end of content -->

     
    <div class="modal fade" id="addConditions" role="modal" style="width: 1000px">
        <div class="modal-dialog modal-lg" title="Add Conditions to various questions" style="width: 900px" >
            <div class="modal-content">
                <input type="hidden" class="refnos2" >
                <input type="hidden" id="quest2" >
                
                <input type="hidden" id="questno" >
                <!-- <input type="hidden" id="currentuser" > -->

                <div class="modal-header" style="padding: 15px 40px; background-color: antiquewhite">
                    <button type="button" class="close" data-dismiss="modal" >&times;</button>
                    <h4 style="text-align: center">Add Conditions to various questions Choices.</h4>
                </div>

                <div class="modal-body" style="height: 300px; ">
                     
                    <div class="col-md-12" id="conditiontbl" >
                      
                    </div>

                    <!-- <div class="form-group-sm col-md-12 res hidden" style="overflow-y: scroll; height: 100px" >

                    </div> -->

                </div>

                <div class="modal-footer col-md-12" style="background-color: antiquewhite">
                    <button type="button" class="btn btn-success rounded" onclick="saveCondition()" id="condition" ><i class="fa fa-arrow-circle-o-up" ></i>Submit</button>
                    <button type="button" class="btn btn-primary" data-toggle='tooltip' title='Close window' id="closer"  data-dismiss="modal">Close</button>
                </div>

            </div>
        </div>
    </div>

    <div class="modal fade" id="pushtodisplay" role="modal" style="width: 1000px">
        <div class="modal-dialog modal-lg" title="Add expected Options for questions" style="width: 900px">
            <div class="modal-content">
                <input type="hidden" class="refnos" >
                <input type="hidden" id="quest" >
                <!-- <input type="hidden" id="currentuser" > -->

                <div class="modal-header" style="padding: 15px 40px; background-color: antiquewhite; color: #fff; font-weight: bolder">
                    <button type="button" class="close" data-dismiss="modal" >&times;</button>
                    <h4 style="color: #000; text-align: center" ><span>Add Options for questions</h4>
                </div>

                <div class="modal-body" style="height: 380px; background-color: whitesmoke">
                    <div class="col-md-12">
                        <!-- <label for="teler1" class="form-label col-md-5" style="font-size: 22px" >Your Question</label>  -->
                        <div class="col-md-12" >
                            <input class="q1 col-md-12" data-toggle="tooltip" readonly  style="font-weight: bolder; font-size: 18px; text-align: center">
                        </div>
                        
                    </div> 
                    
                    <div class="col-md-8" style="background-color: whitesmoke">
                        <!-- <h4 >Add Options</h4> -->
 
                        <div class="form-group col-md-6">
                            <label for="edate" class="col-md-5" >Response Text</label>
                            <input type="text" name="response" id="response" autocomplete="off" class="form-control col-md-7" placeholder="Enter Choice text to be seen by users...">                            
                        </div>
 
                        <div class="form-group col-md-7">
                            <label for="teler1" class="form-label col-md-5" style="font-size: 16px" >Choice Type</label> 
                            
                            <select name="c_type" id="c_type" class="form-control col-md-7">
                                <option value="0"   >Select Choice display type</option>
                                <option value="txt" >Text Input</option>
                                <option value="num" >Number Input</option>
                                
                                <option value="rad" >Radio button</option>
                                <option value="chk" >Check boxes</option>
                                <option value="img" >Image Picker</option>
                            </select>

                        </div>  

                    </div>

                    <div class='col-md-4' >
                        <p class="col-md-12" ><h5>Question Options</h5></p>
                        <div id="choices" class="form-group col-md-12" style="background-color: transparent; height: 280px; overflow: scroll" > 
                            
                        </div> 
                    </div>
                    
                </div>

                <div class="modal-footer col-md-12" style="background-color: antiquewhite">
                    <button type="button" class="btn btn-group-sm rounded" onclick="saveChoices()" id="pusher" ><i class="fa fa-arrow-circle-o-up" ></i>Submit</button>
                    <button type="button" class="btn btn-orange" data-toggle='tooltip' title='Close window' id="closer"  data-dismiss="modal">Close</button>
                </div>

            </div>
        </div>
    </div>
      <!-- Start Project Stats -->
       
<!-- End Fifth Row -->

</div>
<!-- END CONTAINER -->
 <!-- //////////////////////////////////////////////////////////////////////////// --> 

</div>
<!-- End Content -->
 <!-- //////////////////////////////////////////////////////////////////////////// --> 
<!-- //////////////////////////////////////////////////////////////////////////// --> 
 
<!-- ================================================
jQuery Library
================================================ -->
<script type="text/javascript" src="js/jquery.min.js"></script>

<script>
  var user = localStorage.getItem('userid');
  // alert(user)
  $('#usermail').val(user);

  $(document).ready(function(){
    var user = $('#usermail').val();
    // alert(user);

    $.ajax({
      url: "/getprojectslist",
      data: "user="+user,
      type: "get",
      cache: false,
      success: function(data){
        // alert(data)
        $('#projectid').html(data);
      },
      error: function(data){
        alert(data);
      },
      dataType: "text"
    });

  });

  var getQuestion = (id) => {
    $('#r3').removeClass('hidden');
    $.ajax({
      url: "/getquestions",
      data: "projectid="+id,
      type: "get",
      cache: false,
      success: function(data) {
        console.log(data);
        // alert(data)
        var arr = data.split('$');
        // alert(arr[3])
        $('#result').html(arr[2]);
        $('#questtotal').html(arr[4]);
      },
      error: function(data){
        alert(data);
      },
      dataType: "text"
    })  
  };

  var editQuestion = (id) => {
    $.ajax({
      url: "/editquestion",
      data: "questionid="+id,
      cache: false, 
      type: "GET",
      success: (data) => {
        alert(data);
      },
      error: (data) => {

      }

    });

  };

  var addQuestion = (inserObject) => {


  }

  var questionCondition = (id) => {
    $('#questno').val(id);
    var projectid = $('#projectid').val();

    // alert(projectid)
    $("#addConditions").modal({
        backdrop: 'static',
        keyboard: false
    });

    $.ajax({
      url: "/setQuestionCondition",
      data: "questionid="+id+"&projectid="+projectid,
      cache: false, 
      type: "GET",
      success: (data) => {
        $('#conditiontbl').html(data);
      },
      error: (data) => {

      }

    });

  }

  var deleteQuestion = (id) => {
    $.ajax({
      url: "/deletequestion",
      data: "questionid="+id,
      cache: false, 
      type: "GET",
      success: (data) => {
        alert(data);
      },
      error: (data) => {

      }

    });

  }

  var postproject = () => {
    var usermail = $('#usermail').val();
    var title = $('#title').val();
    var start_date = $('#sdate').val();
    var end_date = $('#edate').val();
    var reason = $('#reason').val();

    // alert(usermail);

    $.ajax({
        url: "/newproject",
        data: "usermail="+usermail+"&title="+title+"&sdate="+start_date+"&edate"+end_date+"&reason="+reason,
        cache: false,
        type: "GET",
        success: function(data){
            $('#tbl').html(data);
        },
        error: function(data){
            alert(data);
        },
        datatype: "text"
    });

  }
 
  var openoptions = (id, question) => {
     $(".refnos").val(id);
      $(".q1").val(question);
    $("#pushtodisplay").modal({
        backdrop: 'static',
        keyboard: false
    });

    $.ajax({
        url: "/getquestionoptions",
        type: "GET",
        cache: false,
        data: "questionId="+id , 
        success: function(data){ 
          var questionOptions = '<table class="table table-hover">';

          data.forEach(function(el, xx){
            var y = xx + 1;
            
            questionOptions += '<tr  >' + '<td style="text-align: left; font-size: 14px">'+ y +' </td> <td style="text-align: left; font-size: 14px" >' + data[xx].response_text + '</td> <td><button class="btn btn-primary" id="'+ data[xx].refnos +'" name="'+ data[xx].response_text +'" onclick="deleteOptions(this.id, this.name)" >Delete</button></td>  </tr>';

            // questionOptions += '<td style><button class="btn btn-primary" id="' + data[xx].refnos + '" onclick="deleteOptions(this.id)" >Delete</button>'+ '<td>'+ data[xx].response_text + '</td>'; 
          })

          questionOptions += '</table>';
          
          $('#choices').html(questionOptions);

        },
        error: function(data){

        },
        datatype: "text"
    })
    var resultStr=""; // options.filter(option => option.)
 
}

  var addquestion = () => {
    var usermail  = $('#usermail').val();
    var projectid = $('#projectid').val();
    var question  = $('#question').val();
    var position  = $('#position').val();
    var required  = $('#required').val();

    $.ajax({
        url: "/insertquestion",
        type: "GET",
        cache: false,
        data: "usermail="+usermail+"&projectid="+projectid+"&question="+question+"&position="+position+"&required="+required,
        success: function(data){  
          getQuestion($('#projectid').val());
            
            // $('#res').html(data);
        },
        error: function(data){

        },
        datatype: "text"
    })
    

  }

  var saveChoices = ()=>{
    // alert('Dele')
    // var projectRef = $("#project").val();
    var questionRef = $(".refnos").val();
    var choice = $("#response").val().trim();
    var type = $("#c_type").val().trim(); 

    $.ajax({
        url: "/savechoice",
        type: "get",
        cache: false,
        data: "questionid="+questionRef+"&choice="+choice+"&type="+type,
        success: function(data){
            var str;
            var str ="<table class='table table-hover' >";
            for(var xx=0; xx < data.length; xx++){
                var y = xx + 1;
                
                str += '<tr  >' + '<td style="text-align: left; font-size: 14px">'+ y +' </td> <td style="text-align: left; font-size: 14px" >' + data[xx].response_text + '</td> <td><button class="btn btn-primary" id="'+ data[xx].refnos +'" name="'+ data[xx].response_text +'" onclick="deleteOptions(this.id, this.name)" >Delete</button></td>  </tr>';
            }
            str += "</table>";

            $('#choices').html(str);

        },
        error: function(data){

        },
        datatype: "text"
    });
   
}

var saveCondition = ()=>{
    var questionId = $('.refnos').val();
    var responseId = $('#choice').val();
    var gotoId = $('#goto').val();
    var gotoIndex = ($('#questno').val() - 1);

    
    var dataObj = {
        questionId: questionId, 
        responseId: responseId,
        gotoId: gotoId
    }

    // console.log("data: "+dataObj.questionId)

    // alert(questionId+":::"+responseId+":::"+gotoId)
    $.ajax({
        url: "/savecondition",
        type: "post",
        cache: false,
        // data: dataObj,
        data: "questionId="+questionId+"&responseId="+responseId+"&gotoId="+gotoId+"&gotoIndex="+gotoIndex, //questno
        success: function(data){ 
            var str;
            //  console.log(data)
            $('#choices').html(str);

        },
        error: function(data){

        },
        datatype: "text"
    })
}

  var deleteOptions = (id, name) => {
    var questionId = $('.refnos').val();
    // alert(questionId);
    // return
    $.ajax({
      url: "/deleteOption",
      data: "code="+id+"&questionid="+questionId,
      cache: false,
      type: "GET",
      success: function(data){

        
        $('#choices').html(data);

        // var y=0;
        // // alert(data)
        // var str ="<table class='table table-hover' >";
        //     for(var xx=0; xx < data.length; xx++){
        //         y = xx + 1;
                
        //         str += '<tr  >' + '<td style="text-align: left; font-size: 14px">'+ y +' </td> <td style="text-align: left; font-size: 14px" >' + data[xx].response_text + '</td> <td><button class="btn btn-primary" id="'+ data[xx].refnos +'" name="'+ data[xx].response_text +'" onclick="deleteOptions(this.id, this.name)" >Delete</button></td>  </tr>';
        //     }
        //     str += "</table>";

        //     $('#choices').html(str);

      },
      error: function(data){

      },
      dataType: "text"
    })

  }


</script>

<!-- ================================================
Bootstrap Core JavaScript File
================================================ -->
<script src="js/bootstrap/bootstrap.min.js"></script>

<!-- ================================================
Plugin.js - Some Specific JS codes for Plugin Settings
================================================ -->
<script type="text/javascript" src="js/plugins.js"></script>

<!-- ================================================
Bootstrap Select
================================================ -->
<!-- <script type="text/javascript" src="js/bootstrap-select/bootstrap-select.js"></script> -->

<!-- ================================================
Bootstrap Toggle
================================================ -->
<!-- <script type="text/javascript" src="js/bootstrap-toggle/bootstrap-toggle.min.js"></script> -->

<!-- ================================================
Bootstrap WYSIHTML5
================================================ -->
<!-- main file -->
<!-- <script type="text/javascript" src="js/bootstrap-wysihtml5/wysihtml5-0.3.0.min.js"></script> -->
<!-- bootstrap file -->
<!-- <script type="text/javascript" src="js/bootstrap-wysihtml5/bootstrap-wysihtml5.js"></script> -->

<!-- ================================================
Summernote
================================================ -->
<!-- <script type="text/javascript" src="js/summernote/summernote.min.js"></script> -->

<!-- ================================================
Flot Chart
================================================ -->
<!-- main file -->
<!-- <script type="text/javascript" src="js/flot-chart/flot-chart.js"></script> -->
<!-- time.js -->
<!-- <script type="text/javascript" src="js/flot-chart/flot-chart-time.js"></script> -->
<!-- stack.js -->
<!-- <script type="text/javascript" src="js/flot-chart/flot-chart-stack.js"></script>/ -->
<!-- pie.js -->
<!-- <script type="text/javascript" src="js/flot-chart/flot-chart-pie.js"></script> -->
<!-- demo codes -->
<!-- <script type="text/javascript" src="js/flot-chart/flot-chart-plugin.js"></script> -->

<!-- ================================================
Chartist
================================================ -->
<!-- main file -->
<!-- <script type="text/javascript" src="js/chartist/chartist.js"></script> -->
<!-- demo codes -->
<!-- <script type="text/javascript" src="js/chartist/chartist-plugin.js"></script> -->

<!-- ================================================
Easy Pie Chart
================================================ -->
<!-- main file -->
<!-- <script type="text/javascript" src="js/easypiechart/easypiechart.js"></script> -->
<!-- demo codes -->
<!-- <script type="text/javascript" src="js/easypiechart/easypiechart-plugin.js"></script> -->

<!-- ================================================
Sparkline
================================================ -->
<!-- main file -->
<!-- <script type="text/javascript" src="js/sparkline/sparkline.js"></script> -->
<!-- demo codes -->
<!-- <script type="text/javascript" src="js/sparkline/sparkline-plugin.js"></script> -->

<!-- ================================================
Rickshaw
================================================ -->
<!-- d3 -->
<!-- <script src="js/rickshaw/d3.v3.js"></script> -->
<!-- main file -->
<!-- <script src="js/rickshaw/rickshaw.js"></script> -->
<!-- demo codes -->
<!-- <script src="js/rickshaw/rickshaw-plugin.js"></script> -->

<!-- ================================================
Data Tables
================================================ -->
<script src="js/datatables/datatables.min.js"></script>

<!-- ================================================
Sweet Alert
================================================ -->
<script src="js/sweet-alert/sweet-alert.min.js"></script>

<!-- ================================================
Kode Alert
================================================ -->
<script src="js/kode-alert/main.js"></script>

<!-- ================================================
Gmaps
================================================ -->
<!-- google maps api -->
<!-- <script src="http://maps.google.com/maps/api/js?sensor=true"></script> -->
<!-- main file -->
<!-- <script src="js/gmaps/gmaps.js"></script> -->
<!-- demo codes -->
<!-- <script src="js/gmaps/gmaps-plugin.js"></script> -->

<!-- ================================================
jQuery UI
================================================ -->
<!-- <script type="text/javascript" src="js/jquery-ui/jquery-ui.min.js"></script> -->

<!-- ================================================
Moment.js
================================================ -->
<!-- <script type="text/javascript" src="js/moment/moment.min.js"></script> -->

<!-- ================================================
Full Calendar
================================================ -->
<!-- <script type="text/javascript" src="js/full-calendar/fullcalendar.js"></script> -->

<!-- ================================================
Bootstrap Date Range Picker
================================================ -->
<!-- <script type="text/javascript" src="js/date-range-picker/daterangepicker.js"></script> -->
 

<!-- ================================================
Below codes are only for index widgets
================================================ -->
<!-- Today Sales -->
<script>
  
// set up our data series with 50 random data points

// var seriesData = [ [], [], [] ];
// var random = new Rickshaw.Fixtures.RandomData(20);

// for (var i = 0; i < 110; i++) {
//   random.addData(seriesData);
// }

// instantiate our graph!

// var graph = new Rickshaw.Graph( {
//   element: document.getElementById("todaysales"),
//   renderer: 'bar',
//   series: [
//     {
//       color: "#33577B",
//       data: seriesData[0],
//       name: 'Photodune'
//     }, {
//       color: "#77BBFF",
//       data: seriesData[1],
//       name: 'Themeforest'
//     }, {
//       color: "#C1E0FF",
//       data: seriesData[2],
//       name: 'Codecanyon'
//     }
//   ]
// } );

// graph.render();

// var hoverDetail = new Rickshaw.Graph.HoverDetail( {
//   graph: graph,
//   formatter: function(series, x, y) {
//     var date = '<span class="date">' + new Date(x * 1000).toUTCString() + '</span>';
//     var swatch = '<span class="detail_swatch" style="background-color: ' + series.color + '"></span>';
//     var content = swatch + series.name + ": " + parseInt(y) + '<br>' + date;
//     return content;
//   }
// } );

</script>

<!-- Today Activity -->
<script>
// set up our data series with 50 random data points

// var seriesData = [ [], [], [] ];
// var random = new Rickshaw.Fixtures.RandomData(20);

// for (var i = 0; i < 50; i++) {
//   random.addData(seriesData);
// }

// instantiate our graph!

// var graph = new Rickshaw.Graph( {
//   element: document.getElementById("todayactivity"),
//   renderer: 'area',
//   series: [
//     {
//       color: "#9A80B9",
//       data: seriesData[0],
//       name: 'London'
//     }, {
//       color: "#CDC0DC",
//       data: seriesData[1],
//       name: 'Tokyo'
//     }
//   ]
// } );

// graph.render();

// var hoverDetail = new Rickshaw.Graph.HoverDetail( {
//   graph: graph,
//   formatter: function(series, x, y) {
//     var date = '<span class="date">' + new Date(x * 1000).toUTCString() + '</span>';
//     var swatch = '<span class="detail_swatch" style="background-color: ' + series.color + '"></span>';
//     var content = swatch + series.name + ": " + parseInt(y) + '<br>' + date;
//     return content;
//   }
// } );

// var getdata = () => {
//     alert('dele')
// }
    


</script>



</body>
</html>